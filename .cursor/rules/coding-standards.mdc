# ğŸ’» LockApp Kodlama StandartlarÄ±

## **ğŸ¯ Temel Prensipler**
1. **Clean Code:** Kod okunabilir ve anlaÅŸÄ±lÄ±r olmalÄ±
2. **Strict Typing:** `any` kullanÄ±mÄ± yasak, tam type safety
3. **Descriptive Naming:** DeÄŸiÅŸken ve fonksiyon isimleri aÃ§Ä±klayÄ±cÄ±
4. **Single Responsibility:** Her class/method tek sorumluluk

## **ğŸ“ Dart/Flutter Kodlama KurallarÄ±**

### **ğŸ”¤ Naming Conventions**

```dart
// âœ… DOÄRU
class UserAuthService {}
class DeviceModel {}
enum UserRole { parent, child }

// âŒ YANLIÅ
class userservice {}
class device {}
enum role { PARENT, CHILD }
```

### **ğŸ“¦ Import Statements**

```dart
// âœ… DOÄRU - SÄ±ralama
import 'dart:async';
import 'dart:convert';

import 'package:flutter/material.dart';
import 'package:flutter_riverpod/flutter_riverpod.dart';

import 'package:lockapp/src/api/auth_service.dart';
import 'package:lockapp/src/types/user_model.dart';

// âŒ YANLIÅ - Relative imports
import '../../api/auth_service.dart';
import '../../../types/user_model.dart';
```

### **ğŸ¨ Widget Structure**

```dart
// âœ… DOÄRU Widget YapÄ±sÄ±
class LoginScreen extends ConsumerStatefulWidget {
  const LoginScreen({super.key});

  @override
  ConsumerState<LoginScreen> createState() => _LoginScreenState();
}

class _LoginScreenState extends ConsumerState<LoginScreen> {
  final _formKey = GlobalKey<FormState>();
  final _emailController = TextEditingController();
  
  @override
  void dispose() {
    _emailController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(title: const Text('Login')),
      body: _buildBody(),
    );
  }

  Widget _buildBody() {
    return Padding(
      padding: const EdgeInsets.all(16.0),
      child: Form(
        key: _formKey,
        child: Column(
          children: [
            _buildEmailField(),
            _buildPasswordField(),
            _buildLoginButton(),
          ],
        ),
      ),
    );
  }

  Widget _buildEmailField() {
    return TextFormField(
      controller: _emailController,
      decoration: const InputDecoration(labelText: 'Email'),
      validator: (value) => value?.isEmpty ?? true ? 'Email required' : null,
    );
  }
}
```

### **ğŸ”’ State Management (Riverpod)**

```dart
// âœ… DOÄRU Provider YapÄ±sÄ±
@riverpod
class AuthNotifier extends _$AuthNotifier {
  @override
  AsyncValue<User?> build() {
    return const AsyncValue.loading();
  }

  Future<void> login(String email, String password) async {
    state = const AsyncValue.loading();
    
    try {
      final user = await ref.read(authServiceProvider).login(email, password);
      state = AsyncValue.data(user);
    } catch (error, stackTrace) {
      state = AsyncValue.error(error, stackTrace);
    }
  }
}

// Provider kullanÄ±mÄ±
class LoginScreen extends ConsumerWidget {
  @override
  Widget build(BuildContext context, WidgetRef ref) {
    final authState = ref.watch(authNotifierProvider);
    
    return authState.when(
      data: (user) => user != null ? DashboardScreen() : LoginForm(),
      loading: () => const CircularProgressIndicator(),
      error: (error, stack) => ErrorWidget(error.toString()),
    );
  }
}
```

### **ğŸŒ API Service Pattern**

```dart
// âœ… DOÄRU API Service
abstract class AuthService {
  Future<User> login(String email, String password);
  Future<User> register(String email, String password, String name);
  Future<void> logout();
}

class SupabaseAuthService implements AuthService {
  final SupabaseClient _client;
  
  SupabaseAuthService(this._client);

  @override
  Future<User> login(String email, String password) async {
    try {
      final response = await _client.auth.signInWithPassword(
        email: email,
        password: password,
      );
      
      if (response.user == null) {
        throw AuthException('Login failed');
      }
      
      return User.fromSupabaseUser(response.user!);
    } catch (e) {
      throw AuthException('Login failed: ${e.toString()}');
    }
  }
}
```

### **ğŸ“Š Model Classes**

```dart
// âœ… DOÄRU Model YapÄ±sÄ±
@JsonSerializable()
class UserModel {
  final String id;
  final String email;
  final String name;
  final UserRole role;
  final DateTime createdAt;
  final DateTime updatedAt;

  const UserModel({
    required this.id,
    required this.email,
    required this.name,
    required this.role,
    required this.createdAt,
    required this.updatedAt,
  });

  factory UserModel.fromJson(Map<String, dynamic> json) =>
      _$UserModelFromJson(json);

  Map<String, dynamic> toJson() => _$UserModelToJson(this);

  UserModel copyWith({
    String? id,
    String? email,
    String? name,
    UserRole? role,
    DateTime? createdAt,
    DateTime? updatedAt,
  }) {
    return UserModel(
      id: id ?? this.id,
      email: email ?? this.email,
      name: name ?? this.name,
      role: role ?? this.role,
      createdAt: createdAt ?? this.createdAt,
      updatedAt: updatedAt ?? this.updatedAt,
    );
  }

  @override
  bool operator ==(Object other) {
    if (identical(this, other)) return true;
    return other is UserModel && other.id == id;
  }

  @override
  int get hashCode => id.hashCode;
}
```

### **âš ï¸ Error Handling**

```dart
// âœ… DOÄRU Error Handling
class AppException implements Exception {
  final String message;
  final String? code;
  final dynamic originalError;

  AppException(this.message, {this.code, this.originalError});

  @override
  String toString() => 'AppException: $message';
}

class AuthException extends AppException {
  AuthException(String message) : super(message, code: 'AUTH_ERROR');
}

// Service'de kullanÄ±m
Future<User> login(String email, String password) async {
  try {
    // API call
  } on SupabaseException catch (e) {
    throw AuthException('Login failed: ${e.message}');
  } catch (e) {
    throw AppException('Unexpected error: ${e.toString()}');
  }
}
```

### **ğŸ¨ Theme ve Styling**

```dart
// âœ… DOÄRU Theme KullanÄ±mÄ±
class PrimaryButton extends StatelessWidget {
  final String text;
  final VoidCallback? onPressed;
  final bool isLoading;

  const PrimaryButton({
    super.key,
    required this.text,
    this.onPressed,
    this.isLoading = false,
  });

  @override
  Widget build(BuildContext context) {
    return SizedBox(
      width: double.infinity,
      height: 48.h, // ScreenUtil kullanÄ±mÄ±
      child: ElevatedButton(
        onPressed: isLoading ? null : onPressed,
        style: ElevatedButton.styleFrom(
          backgroundColor: AppColors.primary,
          foregroundColor: AppColors.white,
          shape: RoundedRectangleBorder(
            borderRadius: BorderRadius.circular(8.r),
          ),
        ),
        child: isLoading
            ? const SizedBox(
                width: 20,
                height: 20,
                child: CircularProgressIndicator(strokeWidth: 2),
              )
            : Text(
                text,
                style: AppTextStyles.buttonText,
              ),
      ),
    );
  }
}
```

## **ğŸš« Yasak KullanÄ±mlar**

### **âŒ YAPILMAMASI GEREKENLER**

```dart
// âŒ Dynamic kullanÄ±mÄ±
dynamic user = getUser();

// âŒ Any kullanÄ±mÄ±
Map<String, dynamic> data = {}; // Kabul edilebilir sadece JSON iÃ§in

// âŒ Relative imports
import '../../services/auth.dart';

// âŒ BÃ¼yÃ¼k build methods
Widget build(BuildContext context) {
  return Scaffold(
    body: Column(
      children: [
        // 100+ satÄ±r kod...
      ],
    ),
  );
}

// âŒ Hardcoded values
Container(
  width: 200,
  height: 50,
  color: Colors.blue,
);

// âŒ Null safety ignore
String? name;
print(name!); // Tehlikeli
```

### **âœ… DOÄRU ALTERNATIFLER**

```dart
// âœ… Proper typing
User user = await authService.getUser();

// âœ… Absolute imports
import 'package:lockapp/src/api/auth_service.dart';

// âœ… Extracted methods
Widget build(BuildContext context) {
  return Scaffold(
    body: _buildBody(),
  );
}

Widget _buildBody() {
  return Column(
    children: [
      _buildHeader(),
      _buildContent(),
      _buildFooter(),
    ],
  );
}

// âœ… Theme values
Container(
  width: 200.w,
  height: 50.h,
  color: AppColors.primary,
);

// âœ… Safe null handling
String? name;
if (name != null) {
  print(name);
}
```

## **ğŸ“‹ Code Review Checklist**

### **Before Commit:**
- [ ] TÃ¼m imports absolute path kullanÄ±yor
- [ ] Hardcoded values yok
- [ ] Error handling mevcut
- [ ] Widget'lar 100 satÄ±rdan az
- [ ] Null safety doÄŸru kullanÄ±lmÄ±ÅŸ
- [ ] Naming conventions takip edilmiÅŸ
- [ ] TODO yorumlarÄ± minimize edilmiÅŸ

### **Performance:**
- [ ] Unnecessary rebuilds yok
- [ ] Dispose methods implemented
- [ ] Image optimization yapÄ±lmÄ±ÅŸ
- [ ] List optimization (ListView.builder)

### **Security:**
- [ ] Sensitive data hardcoded deÄŸil
- [ ] Input validation mevcut
- [ ] API errors properly handled

**Bu standartlara uymak zorunludur!** ğŸš¨
description:
globs:
alwaysApply: false
---
